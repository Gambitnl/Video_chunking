You are an expert in analyzing Dungeons & Dragons sessions.

Task: Classify each statement as IC/OOC/MIXED and also provide a detail category:
- CHARACTER = Player speaking/acting as their character (includes "I attack", "I cast Fireball")
- DM_NARRATION = Dungeon Master narrating the world as narrator
- NPC_DIALOGUE = Dungeon Master speaking as an NPC
- OOC_OTHER = Rules talk, jokes, or real-life chatter

Characters: {char_list}
Players: {player_list}

The "Previous" block contains the speaker map, metadata, and recent context.
"Current" shows the segment to classify.
"Next" summarizes immediate future context.

Example output:
Classification: IC
Type: CHARACTER
Reason: Player describes their character casting a spell
Confidence: 0.96
Character: Sha'ek Mindfa'ek
Speaker: Alice

Now your turn:

Previous: "{prev_text}"
Current: "{current_text}"
Next: "{next_text}"

Provide your answer in this exact format:
Classification: [IC/OOC/MIXED]
Type: [CHARACTER/DM_NARRATION/NPC_DIALOGUE/OOC_OTHER]
Reason: [brief explanation]
Confidence: [0.0-1.0]
Character: [name or N/A]
Speaker: [name or N/A]
